-- Configure Attendee Account for Telco
ALTER SESSION SET QUERY_TAG = '''{"origin":"sf_sit-is", "name":"Build an AI Assistant for Telecommunications using Cortex and Document AI", "version":{"major":1, "minor":0},"attributes":{"is_quickstart":0, "source":"sql"}}''';
-- Create the warehouse
USE ROLE ACCOUNTADMIN;

SELECT SYSTEM$DISABLE_BEHAVIOR_CHANGE_BUNDLE('2025_04');

ALTER ACCOUNT SET CORTEX_ENABLED_CROSS_REGION = 'ANY_REGION';



CREATE OR REPLACE WAREHOUSE {{ env.EVENT_WAREHOUSE }}
WITH
  WAREHOUSE_SIZE = 'MEDIUM'
  AUTO_SUSPEND = 60
  AUTO_RESUME = TRUE
  INITIALLY_SUSPENDED = TRUE;


use warehouse {{ env.EVENT_WAREHOUSE }};

-----make listings available in chosen region -----

CALL SYSTEM$REQUEST_LISTING_AND_WAIT('GZTYZ1US93D', 60);

----- Disable mandatory MFA -----
USE ROLE ACCOUNTADMIN;

CREATE DATABASE IF NOT EXISTS policy_db;
USE DATABASE policy_db;

CREATE SCHEMA IF NOT EXISTS policies;
USE SCHEMA policies;

CREATE AUTHENTICATION POLICY IF NOT EXISTS event_authentication_policy;

ALTER AUTHENTICATION POLICY event_authentication_policy SET
  MFA_ENROLLMENT=OPTIONAL
  CLIENT_TYPES = ('ALL')
  AUTHENTICATION_METHODS = ('ALL');

EXECUTE IMMEDIATE $$
    BEGIN
        ALTER ACCOUNT SET AUTHENTICATION POLICY event_authentication_policy;
    EXCEPTION
        WHEN STATEMENT_ERROR THEN
            RETURN SQLERRM;
    END;
$$
;
---------------------------------


-- Create the Attendee role if it does not exist
use role SECURITYADMIN;
create role if not exists {{ env.EVENT_ATTENDEE_ROLE }};

-- Ensure account admin can see what {{ env.EVENT_ATTENDEE_ROLE }} can see
grant role {{ env.EVENT_ATTENDEE_ROLE }} to role ACCOUNTADMIN;

-- Grant the necessary priviliges to that role.
use role ACCOUNTADMIN;
grant CREATE DATABASE on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant CREATE ROLE on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant CREATE WAREHOUSE on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant MANAGE GRANTS on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant CREATE INTEGRATION on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant CREATE APPLICATION PACKAGE on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant CREATE APPLICATION on account to role {{ env.EVENT_ATTENDEE_ROLE }};
grant IMPORT SHARE on account to role {{ env.EVENT_ATTENDEE_ROLE }};

-- Create the users
use role USERADMIN;
create user IF NOT EXISTS {{ env.EVENT_USER_NAME }}
    PASSWORD = '{{ env.EVENT_USER_PASSWORD }}'
    LOGIN_NAME = {{ env.EVENT_USER_NAME }}
    FIRST_NAME = '{{ env.EVENT_USER_FIRST_NAME }}'
    LAST_NAME = '{{ env.EVENT_USER_LAST_NAME }}'
    MUST_CHANGE_PASSWORD = false
    TYPE = PERSON;
create user IF NOT EXISTS {{ env.EVENT_ADMIN_NAME }}
    PASSWORD = '{{ env.EVENT_ADMIN_PASSWORD }}'
    LOGIN_NAME = {{ env.EVENT_ADMIN_NAME }}
    FIRST_NAME = 'EVENT'
    LAST_NAME = 'ADMIN'
    MUST_CHANGE_PASSWORD = false
    TYPE = PERSON;

-- Ensure the user can use the role and warehouse
use role SECURITYADMIN;
grant role {{ env.EVENT_ATTENDEE_ROLE }} to user {{ env.EVENT_USER_NAME }};
grant role ACCOUNTADMIN to user {{ env.EVENT_USER_NAME }};
grant USAGE on warehouse {{ env.EVENT_WAREHOUSE }} to role {{ env.EVENT_ATTENDEE_ROLE }};

-- Ensure ADMIN can use ACCOUNTADMIN role
grant role ACCOUNTADMIN to user {{ env.EVENT_ADMIN_NAME }};
grant role ACCOUNTADMIN to user {{env.EVENT_USER_NAME }};

-- Alter the users to set default role and warehouse
use role USERADMIN;
alter user {{ env.EVENT_USER_NAME }} set
    DEFAULT_ROLE = {{ env.EVENT_ATTENDEE_ROLE }}
    DEFAULT_WAREHOUSE = {{ env.EVENT_WAREHOUSE }};
alter user {{ env.EVENT_ADMIN_NAME }} set
    DEFAULT_ROLE = ACCOUNTADMIN
    DEFAULT_WAREHOUSE = {{ env.EVENT_WAREHOUSE }};

-- Create the database and schemas using {{ env.EVENT_ATTENDEE_ROLE }}
use role {{ env.EVENT_ATTENDEE_ROLE }};

create database IF NOT EXISTS {{ env.DATAOPS_DATABASE }};
create schema IF NOT EXISTS {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }};
create schema IF NOT EXISTS {{env.DATAOPS_DATABASE }}.{{env.DOCUMENT_AI_SCHEMA}};
create schema IF NOT EXISTS {{env.DATAOPS_DATABASE }}.{{env.CORTEX_ANALYST_SCHEMA}};



-- =====================================================
-- TELCO INDUSTRY DATA SETUP
-- =====================================================

-- 1. NETWORK PERFORMANCE TABLE
CREATE OR REPLACE TABLE {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_PERFORMANCE (
    CELL_TOWER_ID VARCHAR(50),
    NETWORK_TYPE VARCHAR(20),
    REGION VARCHAR(50),
    MEASUREMENT_TIMESTAMP TIMESTAMP_NTZ,
    LATENCY_MS FLOAT,
    THROUGHPUT_MBPS FLOAT,
    PACKET_LOSS_PERCENT FLOAT,
    UPTIME_PERCENT FLOAT
);

-- Insert sample network performance data (using timestamps 30-60 days ago for stable analytics)
INSERT INTO {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_PERFORMANCE VALUES
-- Northeast Region - 5G Towers (1-2 months ago for stable analytics)
('TOWER_NYC_001', '5G', 'Northeast', DATEADD(day, -32, CURRENT_TIMESTAMP()), 8.5, 1200.5, 0.05, 99.95),
('TOWER_NYC_001', '5G', 'Northeast', DATEADD(day, -31, CURRENT_TIMESTAMP()), 9.2, 1180.3, 0.08, 99.92),
('TOWER_NYC_001', '5G', 'Northeast', DATEADD(day, -30, CURRENT_TIMESTAMP()), 7.8, 1250.1, 0.03, 99.98),
('TOWER_BOS_015', '5G', 'Northeast', DATEADD(day, -35, CURRENT_TIMESTAMP()), 12.1, 980.7, 0.12, 99.85),
('TOWER_BOS_015', '5G', 'Northeast', DATEADD(day, -34, CURRENT_TIMESTAMP()), 11.5, 1050.2, 0.09, 99.88),
-- West Coast Region - 5G Towers  
('TOWER_LA_045', '5G', 'West_Coast', DATEADD(day, -37, CURRENT_TIMESTAMP()), 10.2, 1100.8, 0.07, 99.90),
('TOWER_LA_045', '5G', 'West_Coast', DATEADD(day, -36, CURRENT_TIMESTAMP()), 9.8, 1145.6, 0.06, 99.93),
('TOWER_SF_032', '5G', 'West_Coast', DATEADD(day, -40, CURRENT_TIMESTAMP()), 13.5, 890.4, 0.15, 99.82),
('TOWER_SF_032', '5G', 'West_Coast', DATEADD(day, -39, CURRENT_TIMESTAMP()), 12.8, 920.1, 0.11, 99.86),
-- Midwest Region - 4G LTE Towers
('TOWER_CHI_023', '4G_LTE', 'Midwest', DATEADD(day, -42, CURRENT_TIMESTAMP()), 18.7, 450.3, 0.25, 99.70),
('TOWER_CHI_023', '4G_LTE', 'Midwest', DATEADD(day, -41, CURRENT_TIMESTAMP()), 17.9, 485.7, 0.22, 99.75),
('TOWER_DET_041', '4G_LTE', 'Midwest', DATEADD(day, -45, CURRENT_TIMESTAMP()), 22.1, 380.9, 0.30, 99.65),
('TOWER_DET_041', '4G_LTE', 'Midwest', DATEADD(day, -44, CURRENT_TIMESTAMP()), 20.5, 410.2, 0.28, 99.68),
-- Rural Areas - 3G Network
('TOWER_RUR_101', '3G', 'Rural_South', DATEADD(day, -48, CURRENT_TIMESTAMP()), 45.2, 85.3, 1.2, 98.90),
('TOWER_RUR_101', '3G', 'Rural_South', DATEADD(day, -47, CURRENT_TIMESTAMP()), 48.7, 78.9, 1.5, 98.85),
('TOWER_RUR_205', '3G', 'Rural_West', DATEADD(day, -50, CURRENT_TIMESTAMP()), 52.1, 72.1, 1.8, 98.75),
('TOWER_RUR_205', '3G', 'Rural_West', DATEADD(day, -49, CURRENT_TIMESTAMP()), 49.3, 81.4, 1.6, 98.80),

-- EXPANDED SAMPLE DATA: Additional Network Performance Records
-- 5G Ultra-High Performance (Major Cities)
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -60, CURRENT_TIMESTAMP()), 8.2, 1250.8, 0.05, 99.98),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -59, CURRENT_TIMESTAMP()), 7.8, 1320.5, 0.04, 99.99),
('TOWER_5G_NYC_002', '5G_ULTRA', 'Northeast', DATEADD(day, -58, CURRENT_TIMESTAMP()), 9.1, 1180.9, 0.06, 99.97),
('TOWER_5G_LA_001', '5G_ULTRA', 'West_Coast', DATEADD(day, -57, CURRENT_TIMESTAMP()), 8.5, 1290.3, 0.05, 99.98),
('TOWER_5G_LA_002', '5G_ULTRA', 'West_Coast', DATEADD(day, -56, CURRENT_TIMESTAMP()), 7.9, 1350.7, 0.04, 99.99),
('TOWER_5G_CHI_001', '5G_ULTRA', 'Midwest', DATEADD(day, -55, CURRENT_TIMESTAMP()), 9.3, 1220.4, 0.07, 99.96),
('TOWER_5G_MIA_001', '5G_ULTRA', 'Southeast', DATEADD(day, -54, CURRENT_TIMESTAMP()), 8.7, 1270.6, 0.05, 99.98),

-- Standard 5G Network (Suburban Areas)
('TOWER_5G_SUB_101', '5G', 'Northeast', DATEADD(day, -53, CURRENT_TIMESTAMP()), 12.4, 850.2, 0.15, 99.85),
('TOWER_5G_SUB_102', '5G', 'Northeast', DATEADD(day, -52, CURRENT_TIMESTAMP()), 11.8, 890.7, 0.12, 99.88),
('TOWER_5G_SUB_201', '5G', 'West_Coast', DATEADD(day, -51, CURRENT_TIMESTAMP()), 13.1, 820.5, 0.18, 99.82),
('TOWER_5G_SUB_301', '5G', 'Midwest', DATEADD(day, -50, CURRENT_TIMESTAMP()), 12.9, 875.3, 0.16, 99.84),
('TOWER_5G_SUB_401', '5G', 'Southeast', DATEADD(day, -49, CURRENT_TIMESTAMP()), 11.5, 910.8, 0.11, 99.89),
('TOWER_5G_SUB_501', '5G', 'Southwest', DATEADD(day, -48, CURRENT_TIMESTAMP()), 13.5, 800.9, 0.19, 99.81),

-- 4G LTE Extended Coverage
('TOWER_4G_EXT_101', '4G_LTE', 'Northeast', DATEADD(day, -47, CURRENT_TIMESTAMP()), 18.7, 520.4, 0.25, 99.75),
('TOWER_4G_EXT_102', '4G_LTE', 'Northeast', DATEADD(day, -46, CURRENT_TIMESTAMP()), 19.2, 510.8, 0.28, 99.72),
('TOWER_4G_EXT_201', '4G_LTE', 'West_Coast', DATEADD(day, -45, CURRENT_TIMESTAMP()), 17.9, 545.6, 0.22, 99.78),
('TOWER_4G_EXT_301', '4G_LTE', 'Midwest', DATEADD(day, -44, CURRENT_TIMESTAMP()), 20.1, 490.2, 0.31, 99.69),
('TOWER_4G_EXT_401', '4G_LTE', 'Southeast', DATEADD(day, -43, CURRENT_TIMESTAMP()), 18.3, 530.7, 0.24, 99.76),
('TOWER_4G_EXT_501', '4G_LTE', 'Southwest', DATEADD(day, -42, CURRENT_TIMESTAMP()), 21.4, 470.3, 0.35, 99.65),
('TOWER_4G_EXT_601', '4G_LTE', 'Mountain', DATEADD(day, -41, CURRENT_TIMESTAMP()), 22.8, 445.9, 0.42, 99.58),

-- Rural 3G Extended
('TOWER_3G_RUR_301', '3G', 'Rural_Northeast', DATEADD(day, -40, CURRENT_TIMESTAMP()), 55.7, 65.8, 2.1, 98.45),
('TOWER_3G_RUR_302', '3G', 'Rural_Northeast', DATEADD(day, -39, CURRENT_TIMESTAMP()), 58.2, 58.9, 2.5, 98.20),
('TOWER_3G_RUR_401', '3G', 'Rural_West', DATEADD(day, -38, CURRENT_TIMESTAMP()), 62.1, 52.4, 2.8, 98.10),
('TOWER_3G_RUR_501', '3G', 'Rural_South', DATEADD(day, -37, CURRENT_TIMESTAMP()), 59.4, 61.7, 2.3, 98.35),
('TOWER_3G_RUR_601', '3G', 'Rural_Mountain', DATEADD(day, -36, CURRENT_TIMESTAMP()), 67.8, 45.2, 3.2, 97.85),

-- WiFi Hotspots (Public Areas)
('WIFI_HOT_001', 'WIFI', 'Urban_Centers', DATEADD(day, -35, CURRENT_TIMESTAMP()), 25.3, 180.5, 0.8, 98.95),
('WIFI_HOT_002', 'WIFI', 'Urban_Centers', DATEADD(day, -34, CURRENT_TIMESTAMP()), 28.7, 165.2, 1.1, 98.85),
('WIFI_HOT_201', 'WIFI', 'Transportation', DATEADD(day, -33, CURRENT_TIMESTAMP()), 35.4, 120.8, 1.5, 98.50),
('WIFI_HOT_301', 'WIFI', 'Commercial', DATEADD(day, -32, CURRENT_TIMESTAMP()), 22.1, 195.7, 0.6, 99.15),

-- mmWave 5G (Ultra-Dense Urban)
('TOWER_MMW_001', '5G_MMWAVE', 'Manhattan', DATEADD(day, -31, CURRENT_TIMESTAMP()), 5.2, 2850.4, 0.02, 99.99),
('TOWER_MMW_002', '5G_MMWAVE', 'Manhattan', DATEADD(day, -30, CURRENT_TIMESTAMP()), 4.8, 3120.7, 0.01, 99.99),
('TOWER_MMW_101', '5G_MMWAVE', 'Downtown_LA', DATEADD(day, -29, CURRENT_TIMESTAMP()), 5.5, 2750.8, 0.03, 99.98),
('TOWER_MMW_201', '5G_MMWAVE', 'Chicago_Loop', DATEADD(day, -28, CURRENT_TIMESTAMP()), 5.9, 2650.3, 0.04, 99.97),

-- International Roaming Partners
('TOWER_INTL_001', '4G_LTE', 'International', DATEADD(day, -27, CURRENT_TIMESTAMP()), 85.4, 125.6, 2.5, 97.80),
('TOWER_INTL_002', '5G', 'International', DATEADD(day, -26, CURRENT_TIMESTAMP()), 45.2, 380.9, 1.2, 98.90),

-- Edge Computing Nodes
('EDGE_5G_001', '5G_EDGE', 'Smart_Cities', DATEADD(day, -25, CURRENT_TIMESTAMP()), 6.8, 1850.4, 0.08, 99.95),
('EDGE_5G_002', '5G_EDGE', 'Smart_Cities', DATEADD(day, -24, CURRENT_TIMESTAMP()), 7.2, 1790.8, 0.09, 99.94),

-- Performance during Peak Hours (Recent Data)
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(hour, -12, CURRENT_TIMESTAMP()), 12.1, 980.5, 0.15, 99.92),
('TOWER_5G_LA_001', '5G_ULTRA', 'West_Coast', DATEADD(hour, -10, CURRENT_TIMESTAMP()), 11.8, 1020.7, 0.12, 99.94),
('TOWER_4G_EXT_101', '4G_LTE', 'Northeast', DATEADD(hour, -8, CURRENT_TIMESTAMP()), 24.5, 420.3, 0.45, 99.55),
('TOWER_5G_SUB_101', '5G', 'Northeast', DATEADD(hour, -6, CURRENT_TIMESTAMP()), 16.8, 680.9, 0.28, 99.72),

-- Weather Impact Testing
('TOWER_WTH_001', '5G', 'Storm_Zone', DATEADD(day, -20, CURRENT_TIMESTAMP()), 18.9, 650.4, 0.55, 99.45),
('TOWER_WTH_002', '4G_LTE', 'Storm_Zone', DATEADD(day, -19, CURRENT_TIMESTAMP()), 28.7, 380.2, 0.85, 99.15),

-- Backup Networks (Disaster Recovery)
('TOWER_BCK_001', 'BACKUP_4G', 'Emergency_Zone', DATEADD(day, -18, CURRENT_TIMESTAMP()), 35.6, 280.7, 1.2, 98.80),
('TOWER_BCK_002', 'BACKUP_5G', 'Emergency_Zone', DATEADD(day, -17, CURRENT_TIMESTAMP()), 22.4, 450.8, 0.68, 99.32),

-- Private Network Deployments
('TOWER_PVT_001', '5G_PRIVATE', 'Enterprise', DATEADD(day, -16, CURRENT_TIMESTAMP()), 8.9, 1180.5, 0.08, 99.96),
('TOWER_PVT_002', '5G_PRIVATE', 'Manufacturing', DATEADD(day, -15, CURRENT_TIMESTAMP()), 9.2, 1150.8, 0.09, 99.95),

-- Recent Performance Trend (Last Week)
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -7, CURRENT_TIMESTAMP()), 8.5, 1280.3, 0.06, 99.97),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -6, CURRENT_TIMESTAMP()), 8.1, 1305.7, 0.05, 99.98),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -5, CURRENT_TIMESTAMP()), 7.9, 1340.2, 0.04, 99.99),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -4, CURRENT_TIMESTAMP()), 8.3, 1295.8, 0.05, 99.98),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -3, CURRENT_TIMESTAMP()), 8.7, 1265.4, 0.07, 99.96),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -2, CURRENT_TIMESTAMP()), 8.0, 1315.9, 0.04, 99.99),
('TOWER_5G_NYC_001', '5G_ULTRA', 'Northeast', DATEADD(day, -1, CURRENT_TIMESTAMP()), 7.8, 1355.1, 0.03, 99.99);

-- 2. CUSTOMER USAGE TABLE
CREATE OR REPLACE TABLE {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.CUSTOMER_USAGE (
    CUSTOMER_ID VARCHAR(20),
    SERVICE_PLAN VARCHAR(30),
    DEVICE_TYPE VARCHAR(20),
    USAGE_DATE DATE,
    DATA_USAGE_GB FLOAT,
    VOICE_MINUTES INTEGER,
    SMS_COUNT INTEGER,
    MONTHLY_BILL_AMOUNT FLOAT
);

-- Insert sample customer usage data (using dates 1-60 days ago to ensure compatibility with analytical queries)
INSERT INTO {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.CUSTOMER_USAGE VALUES
-- Premium 5G Customers (1-2 months ago for stable analytics)
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 35, 45.8, 680, 245, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 34, 52.3, 720, 198, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 33, 38.9, 590, 312, 120.75),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 37, 62.1, 450, 156, 125.99),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 36, 58.7, 520, 189, 125.99),
('CUST_3009012', 'PREMIUM_DATA', 'TABLET', CURRENT_DATE() - 40, 28.4, 0, 0, 85.50),
('CUST_3009012', 'PREMIUM_DATA', 'TABLET', CURRENT_DATE() - 39, 31.2, 0, 0, 85.50),
-- Standard Plan Customers
('CUST_4012345', 'PREMIUM_DATA', 'SMARTPHONE', CURRENT_DATE() - 42, 25.6, 320, 89, 65.50),
('CUST_4012345', 'PREMIUM_DATA', 'SMARTPHONE', CURRENT_DATE() - 41, 22.8, 380, 112, 65.50),
('CUST_5067890', 'BASIC_MOBILE', 'SMARTPHONE', CURRENT_DATE() - 45, 12.3, 450, 150, 45.99),
('CUST_5067890', 'BASIC_MOBILE', 'SMARTPHONE', CURRENT_DATE() - 44, 15.7, 390, 134, 45.99),
-- IoT Device Customers
('CUST_6078901', 'IOT_CONNECT', 'IOT_DEVICE', CURRENT_DATE() - 48, 2.1, 0, 0, 15.99),
('CUST_6078901', 'IOT_CONNECT', 'IOT_DEVICE', CURRENT_DATE() - 47, 1.8, 0, 0, 15.99),
('CUST_7089012', 'IOT_CONNECT', 'IOT_DEVICE', CURRENT_DATE() - 50, 3.4, 0, 0, 15.99),
('CUST_8090123', 'FAMILY_PLAN', 'SMARTPHONE', CURRENT_DATE() - 38, 35.2, 890, 267, 95.99),
('CUST_9001234', 'STUDENT_PLAN', 'SMARTPHONE', CURRENT_DATE() - 43, 18.9, 245, 456, 35.99),
-- Additional data spread across last 60 days for robust analytics
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 32, 47.2, 650, 220, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 31, 51.8, 705, 255, 120.75),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 32, 59.4, 485, 175, 125.99),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 31, 61.7, 510, 195, 125.99),
('CUST_4012345', 'PREMIUM_DATA', 'SMARTPHONE', CURRENT_DATE() - 32, 24.1, 340, 95, 65.50),
('CUST_5067890', 'BASIC_MOBILE', 'SMARTPHONE', CURRENT_DATE() - 32, 14.5, 420, 145, 45.99),
('CUST_8090123', 'FAMILY_PLAN', 'SMARTPHONE', CURRENT_DATE() - 31, 38.7, 920, 285, 95.99),

-- EXPANDED SAMPLE DATA: Additional Customer Usage Records
-- Business Enterprise Customers
('CUST_BIZ_1001', 'ENTERPRISE_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 60, 78.5, 1250, 89, 175.99),
('CUST_BIZ_1001', 'ENTERPRISE_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 59, 82.3, 1180, 102, 175.99),
('CUST_BIZ_1001', 'ENTERPRISE_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 58, 75.8, 1320, 76, 175.99),
('CUST_BIZ_1002', 'ENTERPRISE_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 57, 68.9, 980, 145, 175.99),
('CUST_BIZ_1003', 'ENTERPRISE_DATA', 'TABLET', CURRENT_DATE() - 56, 45.2, 0, 0, 85.99),
('CUST_BIZ_1004', 'ENTERPRISE_DATA', 'LAPTOP_MODEM', CURRENT_DATE() - 55, 120.7, 0, 0, 125.99),

-- Senior Citizen Plans
('CUST_SEN_2001', 'SENIOR_BASIC', 'SMARTPHONE', CURRENT_DATE() - 54, 8.5, 180, 45, 29.99),
('CUST_SEN_2001', 'SENIOR_BASIC', 'SMARTPHONE', CURRENT_DATE() - 53, 6.8, 160, 38, 29.99),
('CUST_SEN_2002', 'SENIOR_BASIC', 'SMARTPHONE', CURRENT_DATE() - 52, 12.3, 220, 52, 29.99),
('CUST_SEN_2003', 'SENIOR_PLUS', 'SMARTPHONE', CURRENT_DATE() - 51, 18.7, 340, 78, 39.99),
('CUST_SEN_2004', 'SENIOR_PLUS', 'SMARTPHONE', CURRENT_DATE() - 50, 15.2, 290, 65, 39.99),

-- International Travelers
('CUST_INT_3001', 'GLOBAL_ROAMING', 'SMARTPHONE', CURRENT_DATE() - 49, 35.4, 450, 120, 89.99),
('CUST_INT_3002', 'GLOBAL_ROAMING', 'SMARTPHONE', CURRENT_DATE() - 48, 42.8, 380, 98, 89.99),
('CUST_INT_3003', 'INTERNATIONAL_DATA', 'TABLET', CURRENT_DATE() - 47, 65.9, 0, 0, 75.99),

-- Heavy Data Users (Gamers, Streamers)
('CUST_GAM_4001', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 46, 185.7, 320, 156, 149.99),
('CUST_GAM_4001', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 45, 198.4, 280, 142, 149.99),
('CUST_GAM_4002', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 44, 175.8, 390, 178, 149.99),
('CUST_STR_4003', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 43, 165.2, 410, 89, 149.99),
('CUST_STR_4004', 'UNLIMITED_5G_PLUS', 'TABLET', CURRENT_DATE() - 42, 220.5, 0, 0, 99.99),

-- IoT and Connected Device Customers
('CUST_IOT_5001', 'IOT_CONNECT', 'SMART_WATCH', CURRENT_DATE() - 41, 0.8, 5, 25, 12.99),
('CUST_IOT_5002', 'IOT_CONNECT', 'VEHICLE_MODEM', CURRENT_DATE() - 40, 5.2, 0, 0, 19.99),
('CUST_IOT_5003', 'IOT_CONNECT', 'HOME_SECURITY', CURRENT_DATE() - 39, 2.1, 0, 0, 15.99),
('CUST_IOT_5004', 'IOT_CONNECT', 'AGRICULTURE_SENSOR', CURRENT_DATE() - 38, 1.3, 0, 0, 9.99),
('CUST_IOT_5005', 'IOT_INDUSTRIAL', 'MANUFACTURING_DEVICE', CURRENT_DATE() - 37, 8.7, 0, 0, 45.99),

-- Prepaid Customers
('CUST_PRE_6001', 'PREPAID_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 36, 25.8, 350, 125, 55.00),
('CUST_PRE_6002', 'PREPAID_BASIC', 'SMARTPHONE', CURRENT_DATE() - 35, 12.4, 180, 89, 35.00),
('CUST_PRE_6003', 'PREPAID_DATA', 'SMARTPHONE', CURRENT_DATE() - 34, 18.9, 120, 45, 25.00),
('CUST_PRE_6004', 'PREPAID_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 33, 28.6, 420, 156, 55.00),

-- Family Plans (Multiple Lines)
('CUST_FAM_7001', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 32, 45.8, 680, 234, 180.99),
('CUST_FAM_7002', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 31, 52.3, 720, 198, 180.99),
('CUST_FAM_7003', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 30, 38.9, 590, 312, 180.99),
('CUST_FAM_7004', 'FAMILY_UNLIMITED', 'TABLET', CURRENT_DATE() - 29, 28.4, 0, 0, 180.99),
('CUST_FAM_7005', 'FAMILY_BASIC', 'SMARTPHONE', CURRENT_DATE() - 28, 22.6, 380, 156, 120.99),

-- Student Plans
('CUST_STU_8001', 'STUDENT_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 27, 35.7, 450, 289, 45.99),
('CUST_STU_8002', 'STUDENT_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 26, 42.1, 520, 315, 45.99),
('CUST_STU_8003', 'STUDENT_BASIC', 'SMARTPHONE', CURRENT_DATE() - 25, 18.9, 245, 156, 25.99),
('CUST_STU_8004', 'STUDENT_DATA', 'TABLET', CURRENT_DATE() - 24, 25.4, 0, 0, 35.99),

-- Rural Customers (Lower usage patterns)
('CUST_RUR_9001', 'RURAL_BASIC', 'SMARTPHONE', CURRENT_DATE() - 23, 8.5, 280, 89, 39.99),
('CUST_RUR_9002', 'RURAL_BASIC', 'SMARTPHONE', CURRENT_DATE() - 22, 6.8, 320, 78, 39.99),
('CUST_RUR_9003', 'RURAL_PLUS', 'SMARTPHONE', CURRENT_DATE() - 21, 15.2, 450, 125, 49.99),
('CUST_RUR_9004', 'RURAL_PLUS', 'SMARTPHONE', CURRENT_DATE() - 20, 12.6, 380, 98, 49.99),

-- Small Business Customers
('CUST_SMB_A001', 'SMALL_BIZ_PLAN', 'SMARTPHONE', CURRENT_DATE() - 19, 32.8, 720, 156, 65.99),
('CUST_SMB_A002', 'SMALL_BIZ_PLAN', 'SMARTPHONE', CURRENT_DATE() - 18, 29.4, 680, 142, 65.99),
('CUST_SMB_A003', 'SMALL_BIZ_DATA', 'TABLET', CURRENT_DATE() - 17, 45.7, 0, 0, 55.99),
('CUST_SMB_A004', 'SMALL_BIZ_HOTSPOT', 'HOTSPOT_DEVICE', CURRENT_DATE() - 16, 78.9, 0, 0, 75.99),

-- Mobile Virtual Network Operator (MVNO) Customers
('CUST_MVN_B001', 'MVNO_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 15, 38.5, 520, 178, 49.99),
('CUST_MVN_B002', 'MVNO_BASIC', 'SMARTPHONE', CURRENT_DATE() - 14, 22.8, 340, 89, 29.99),
('CUST_MVN_B003', 'MVNO_DATA', 'TABLET', CURRENT_DATE() - 13, 31.2, 0, 0, 35.99),

-- First Responder Plans
('CUST_FR_C001', 'FIRST_RESPONDER', 'SMARTPHONE', CURRENT_DATE() - 12, 48.9, 890, 125, 55.99),
('CUST_FR_C002', 'FIRST_RESPONDER', 'SMARTPHONE', CURRENT_DATE() - 11, 52.3, 950, 98, 55.99),
('CUST_FR_C003', 'FIRST_RESPONDER_DATA', 'TABLET', CURRENT_DATE() - 10, 35.7, 0, 0, 45.99),

-- High-Value VIP Customers
('CUST_VIP_D001', 'VIP_PREMIUM', 'SMARTPHONE', CURRENT_DATE() - 9, 125.8, 1250, 345, 299.99),
('CUST_VIP_D002', 'VIP_PREMIUM', 'SMARTPHONE', CURRENT_DATE() - 8, 132.4, 1180, 298, 299.99),
('CUST_VIP_D003', 'VIP_PREMIUM', 'TABLET', CURRENT_DATE() - 7, 89.7, 0, 0, 199.99),

-- Recent Activity (Last Week for Fresh Analytics)
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 6, 49.2, 650, 220, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 5, 51.8, 705, 255, 120.75),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 4, 59.4, 485, 175, 125.99),
('CUST_GAM_4001', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 3, 192.3, 295, 167, 149.99),
('CUST_FAM_7001', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 2, 47.6, 695, 245, 180.99),
('CUST_VIP_D001', 'VIP_PREMIUM', 'SMARTPHONE', CURRENT_DATE() - 1, 128.9, 1290, 320, 299.99),

-- Weekend Usage Patterns
('CUST_WKD_E001', 'WEEKEND_WARRIOR', 'SMARTPHONE', CURRENT_DATE() - 7, 85.4, 180, 320, 79.99),
('CUST_WKD_E002', 'WEEKEND_WARRIOR', 'SMARTPHONE', CURRENT_DATE() - 14, 92.7, 165, 285, 79.99),

-- Data-Only Plans
('CUST_DAO_F001', 'DATA_ONLY_50GB', 'TABLET', CURRENT_DATE() - 21, 48.9, 0, 0, 59.99),
('CUST_DAO_F002', 'DATA_ONLY_100GB', 'LAPTOP_MODEM', CURRENT_DATE() - 28, 95.7, 0, 0, 89.99),
('CUST_DAO_F003', 'DATA_ONLY_UNLIMITED', 'HOTSPOT_DEVICE', CURRENT_DATE() - 35, 275.8, 0, 0, 129.99),

-- Monthly trends for the same customers to show usage patterns
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 30, 46.5, 625, 210, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 29, 48.9, 670, 235, 120.75),
('CUST_1001234', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 28, 44.7, 595, 198, 120.75),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 27, 57.8, 465, 165, 125.99),
('CUST_2005678', 'UNLIMITED_5G', 'SMARTPHONE', CURRENT_DATE() - 26, 61.2, 505, 185, 125.99),
('CUST_GAM_4001', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 25, 180.5, 310, 148, 149.99),
('CUST_GAM_4001', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 24, 188.9, 295, 162, 149.99),
('CUST_FAM_7001', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 23, 43.2, 665, 224, 180.99),
('CUST_FAM_7001', 'FAMILY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 22, 46.8, 705, 248, 180.99),

-- Edge cases and interesting patterns
('CUST_LOW_G001', 'BASIC_MOBILE', 'FEATURE_PHONE', CURRENT_DATE() - 45, 0.5, 180, 25, 19.99),
('CUST_HIG_G002', 'UNLIMITED_5G_PLUS', 'SMARTPHONE', CURRENT_DATE() - 38, 485.7, 2850, 1205, 149.99),
('CUST_ZER_G003', 'EMERGENCY_ONLY', 'SMARTPHONE', CURRENT_DATE() - 52, 0.0, 15, 2, 9.99),

-- Corporate Fleet Management
('CUST_FLT_H001', 'FLEET_MANAGEMENT', 'VEHICLE_MODEM', CURRENT_DATE() - 40, 15.8, 0, 0, 25.99),
('CUST_FLT_H002', 'FLEET_MANAGEMENT', 'VEHICLE_MODEM', CURRENT_DATE() - 39, 18.2, 0, 0, 25.99),
('CUST_FLT_H003', 'FLEET_TRACKING', 'GPS_DEVICE', CURRENT_DATE() - 38, 2.4, 0, 0, 12.99),

-- Seasonal Users (Tourists, Temporary)
('CUST_SEA_I001', 'TOURIST_PLAN', 'SMARTPHONE', CURRENT_DATE() - 35, 28.4, 120, 45, 39.99),
('CUST_SEA_I002', 'TEMPORARY_UNLIMITED', 'SMARTPHONE', CURRENT_DATE() - 30, 65.7, 380, 156, 69.99),

-- Government Accounts
('CUST_GOV_J001', 'GOVERNMENT_PLAN', 'SMARTPHONE', CURRENT_DATE() - 25, 42.8, 580, 89, 59.99),
('CUST_GOV_J002', 'GOVERNMENT_DATA', 'TABLET', CURRENT_DATE() - 24, 28.6, 0, 0, 45.99);

-- 3. SERVICE QUALITY METRICS TABLE
CREATE OR REPLACE TABLE {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.SERVICE_QUALITY_METRICS (
    SERVICE_TYPE VARCHAR(30),
    GEOGRAPHIC_AREA VARCHAR(20),
    QUALITY_MEASUREMENT_TIME TIMESTAMP_NTZ,
    CALL_DROP_RATE FLOAT,
    DATA_SUCCESS_RATE FLOAT,
    CUSTOMER_SATISFACTION_SCORE FLOAT
);

INSERT INTO {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.SERVICE_QUALITY_METRICS VALUES
('VOICE_CALL', 'URBAN', DATEADD(hour, -6, CURRENT_TIMESTAMP()), 0.5, 98.5, 4.2),
('VOICE_CALL', 'URBAN', DATEADD(hour, -5, CURRENT_TIMESTAMP()), 0.8, 98.2, 4.1),
('VOICE_CALL', 'URBAN', DATEADD(hour, -4, CURRENT_TIMESTAMP()), 0.3, 98.8, 4.4),
('DATA_SESSION', 'SUBURBAN', DATEADD(hour, -8, CURRENT_TIMESTAMP()), 0.0, 97.8, 3.8),
('DATA_SESSION', 'SUBURBAN', DATEADD(hour, -7, CURRENT_TIMESTAMP()), 0.0, 98.1, 3.9),
('DATA_SESSION', 'SUBURBAN', DATEADD(hour, -6, CURRENT_TIMESTAMP()), 0.0, 97.5, 3.7),
('VIDEO_STREAMING', 'RURAL', DATEADD(day, -1, CURRENT_TIMESTAMP()), 0.0, 95.2, 3.2),
('VIDEO_STREAMING', 'RURAL', DATEADD(hour, -20, CURRENT_TIMESTAMP()), 0.0, 94.8, 3.1),
('VIDEO_STREAMING', 'RURAL', DATEADD(hour, -18, CURRENT_TIMESTAMP()), 0.0, 96.1, 3.4),
('VIDEO_STREAMING', 'URBAN', DATEADD(hour, -3, CURRENT_TIMESTAMP()), 0.0, 99.1, 4.6),
('VIDEO_STREAMING', 'URBAN', DATEADD(hour, -2, CURRENT_TIMESTAMP()), 0.0, 98.9, 4.5),
('VIDEO_STREAMING', 'URBAN', DATEADD(hour, -1, CURRENT_TIMESTAMP()), 0.0, 99.3, 4.7),

-- EXPANDED SAMPLE DATA: Additional Service Quality Metrics
-- 5G Network Quality Across Different Areas
('5G_DATA_SESSION', 'URBAN', DATEADD(hour, -48, CURRENT_TIMESTAMP()), 0.0, 99.8, 4.8),
('5G_DATA_SESSION', 'URBAN', DATEADD(hour, -47, CURRENT_TIMESTAMP()), 0.0, 99.9, 4.9),
('5G_DATA_SESSION', 'SUBURBAN', DATEADD(hour, -46, CURRENT_TIMESTAMP()), 0.0, 99.2, 4.3),
('5G_DATA_SESSION', 'SUBURBAN', DATEADD(hour, -45, CURRENT_TIMESTAMP()), 0.0, 99.5, 4.5),
('5G_DATA_SESSION', 'RURAL', DATEADD(hour, -44, CURRENT_TIMESTAMP()), 0.0, 97.8, 3.9),
('5G_DATA_SESSION', 'RURAL', DATEADD(hour, -43, CURRENT_TIMESTAMP()), 0.0, 98.1, 4.0),

-- Voice Quality Metrics by Region
('VOICE_CALL', 'SUBURBAN', DATEADD(hour, -42, CURRENT_TIMESTAMP()), 0.7, 98.0, 4.0),
('VOICE_CALL', 'SUBURBAN', DATEADD(hour, -41, CURRENT_TIMESTAMP()), 0.6, 98.3, 4.1),
('VOICE_CALL', 'RURAL', DATEADD(hour, -40, CURRENT_TIMESTAMP()), 1.2, 96.8, 3.6),
('VOICE_CALL', 'RURAL', DATEADD(hour, -39, CURRENT_TIMESTAMP()), 1.1, 97.1, 3.7),
('VOICE_CALL', 'MOUNTAIN', DATEADD(hour, -38, CURRENT_TIMESTAMP()), 1.8, 95.2, 3.2),
('VOICE_CALL', 'MOUNTAIN', DATEADD(hour, -37, CURRENT_TIMESTAMP()), 1.6, 95.8, 3.4),

-- Video Conference Quality
('VIDEO_CONFERENCE', 'URBAN', DATEADD(hour, -36, CURRENT_TIMESTAMP()), 0.1, 99.1, 4.6),
('VIDEO_CONFERENCE', 'URBAN', DATEADD(hour, -35, CURRENT_TIMESTAMP()), 0.2, 98.9, 4.5),
('VIDEO_CONFERENCE', 'SUBURBAN', DATEADD(hour, -34, CURRENT_TIMESTAMP()), 0.3, 98.2, 4.2),
('VIDEO_CONFERENCE', 'SUBURBAN', DATEADD(hour, -33, CURRENT_TIMESTAMP()), 0.4, 98.0, 4.1),
('VIDEO_CONFERENCE', 'RURAL', DATEADD(hour, -32, CURRENT_TIMESTAMP()), 0.8, 96.5, 3.5),

-- Gaming and Low-Latency Services
('GAMING', 'URBAN', DATEADD(hour, -31, CURRENT_TIMESTAMP()), 0.0, 99.6, 4.7),
('GAMING', 'URBAN', DATEADD(hour, -30, CURRENT_TIMESTAMP()), 0.0, 99.7, 4.8),
('GAMING', 'SUBURBAN', DATEADD(hour, -29, CURRENT_TIMESTAMP()), 0.1, 98.8, 4.3),
('GAMING', 'SUBURBAN', DATEADD(hour, -28, CURRENT_TIMESTAMP()), 0.1, 98.9, 4.4),
('GAMING', 'RURAL', DATEADD(hour, -27, CURRENT_TIMESTAMP()), 0.5, 96.2, 3.4),

-- IoT Device Performance
('IOT_CONNECTIVITY', 'URBAN', DATEADD(hour, -26, CURRENT_TIMESTAMP()), 0.0, 99.9, 4.5),
('IOT_CONNECTIVITY', 'SUBURBAN', DATEADD(hour, -25, CURRENT_TIMESTAMP()), 0.1, 99.7, 4.3),
('IOT_CONNECTIVITY', 'RURAL', DATEADD(hour, -24, CURRENT_TIMESTAMP()), 0.2, 99.2, 4.0),
('IOT_CONNECTIVITY', 'INDUSTRIAL', DATEADD(hour, -23, CURRENT_TIMESTAMP()), 0.0, 99.8, 4.6),

-- SMS and Messaging Services
('SMS_MMS', 'URBAN', DATEADD(hour, -22, CURRENT_TIMESTAMP()), 0.0, 99.9, 4.8),
('SMS_MMS', 'SUBURBAN', DATEADD(hour, -21, CURRENT_TIMESTAMP()), 0.0, 99.8, 4.7),
('SMS_MMS', 'RURAL', DATEADD(hour, -20, CURRENT_TIMESTAMP()), 0.1, 99.5, 4.4),
('INSTANT_MESSAGING', 'URBAN', DATEADD(hour, -19, CURRENT_TIMESTAMP()), 0.0, 99.7, 4.6),
('INSTANT_MESSAGING', 'SUBURBAN', DATEADD(hour, -18, CURRENT_TIMESTAMP()), 0.0, 99.5, 4.4),

-- Cloud and Enterprise Services
('CLOUD_SYNC', 'BUSINESS_DISTRICT', DATEADD(hour, -17, CURRENT_TIMESTAMP()), 0.0, 99.4, 4.5),
('CLOUD_SYNC', 'BUSINESS_DISTRICT', DATEADD(hour, -16, CURRENT_TIMESTAMP()), 0.0, 99.6, 4.6),
('VPN_CONNECTION', 'ENTERPRISE_ZONE', DATEADD(hour, -15, CURRENT_TIMESTAMP()), 0.1, 98.9, 4.3),
('VPN_CONNECTION', 'ENTERPRISE_ZONE', DATEADD(hour, -14, CURRENT_TIMESTAMP()), 0.1, 99.1, 4.4),

-- Emergency Services Quality
('EMERGENCY_CALL', 'URBAN', DATEADD(hour, -13, CURRENT_TIMESTAMP()), 0.0, 99.99, 4.95),
('EMERGENCY_CALL', 'SUBURBAN', DATEADD(hour, -12, CURRENT_TIMESTAMP()), 0.0, 99.98, 4.92),
('EMERGENCY_CALL', 'RURAL', DATEADD(hour, -11, CURRENT_TIMESTAMP()), 0.1, 99.95, 4.85),
('EMERGENCY_SMS', 'DISASTER_ZONE', DATEADD(hour, -10, CURRENT_TIMESTAMP()), 0.0, 99.9, 4.8),

-- International Roaming Quality
('ROAMING_DATA', 'INTERNATIONAL', DATEADD(hour, -9, CURRENT_TIMESTAMP()), 2.5, 94.8, 3.2),
('ROAMING_VOICE', 'INTERNATIONAL', DATEADD(hour, -8, CURRENT_TIMESTAMP()), 3.2, 93.5, 3.0),
('ROAMING_SMS', 'INTERNATIONAL', DATEADD(hour, -7, CURRENT_TIMESTAMP()), 1.8, 96.2, 3.8),

-- Peak Hour Performance
('DATA_SESSION', 'URBAN', DATEADD(hour, -6, CURRENT_TIMESTAMP()), 0.2, 97.5, 4.0),
('DATA_SESSION', 'URBAN', DATEADD(hour, -5, CURRENT_TIMESTAMP()), 0.3, 97.2, 3.9),
('VOICE_CALL', 'URBAN', DATEADD(hour, -4, CURRENT_TIMESTAMP()), 1.2, 97.8, 4.1),
('VIDEO_STREAMING', 'SUBURBAN', DATEADD(hour, -3, CURRENT_TIMESTAMP()), 0.2, 97.9, 4.0),

-- WiFi Offload Quality
('WIFI_OFFLOAD', 'COMMERCIAL', DATEADD(hour, -25, CURRENT_TIMESTAMP()), 0.8, 96.5, 3.8),
('WIFI_OFFLOAD', 'RESIDENTIAL', DATEADD(hour, -24, CURRENT_TIMESTAMP()), 1.2, 95.2, 3.5),
('WIFI_OFFLOAD', 'TRANSPORTATION', DATEADD(hour, -23, CURRENT_TIMESTAMP()), 2.1, 92.8, 3.1),

-- Edge Computing Services
('EDGE_COMPUTING', 'SMART_CITY', DATEADD(hour, -22, CURRENT_TIMESTAMP()), 0.0, 99.5, 4.7),
('EDGE_COMPUTING', 'INDUSTRIAL', DATEADD(hour, -21, CURRENT_TIMESTAMP()), 0.1, 99.3, 4.5),
('AUGMENTED_REALITY', 'ENTERTAINMENT', DATEADD(hour, -20, CURRENT_TIMESTAMP()), 0.2, 98.8, 4.2),

-- Weather Impact on Service Quality
('DATA_SESSION', 'STORM_AFFECTED', DATEADD(day, -2, CURRENT_TIMESTAMP()), 1.5, 94.2, 3.3),
('VOICE_CALL', 'STORM_AFFECTED', DATEADD(day, -2, CURRENT_TIMESTAMP()), 2.8, 92.5, 3.0),
('SMS_MMS', 'STORM_AFFECTED', DATEADD(day, -2, CURRENT_TIMESTAMP()), 0.8, 96.8, 3.8),

-- Special Event Coverage
('DATA_SESSION', 'EVENT_VENUE', DATEADD(day, -1, CURRENT_TIMESTAMP()), 0.8, 96.8, 3.9),
('VOICE_CALL', 'EVENT_VENUE', DATEADD(day, -1, CURRENT_TIMESTAMP()), 1.5, 95.5, 3.6),
('VIDEO_STREAMING', 'EVENT_VENUE', DATEADD(day, -1, CURRENT_TIMESTAMP()), 1.2, 96.2, 3.7),

-- Network Slicing Performance
('5G_SLICE_ENHANCED', 'URBAN', DATEADD(hour, -12, CURRENT_TIMESTAMP()), 0.0, 99.9, 4.9),
('5G_SLICE_MASSIVE_IOT', 'INDUSTRIAL', DATEADD(hour, -11, CURRENT_TIMESTAMP()), 0.1, 99.7, 4.3),
('5G_SLICE_URLLC', 'AUTONOMOUS_ZONE', DATEADD(hour, -10, CURRENT_TIMESTAMP()), 0.0, 99.95, 4.95);

-- 4. NETWORK INCIDENTS TABLE
CREATE OR REPLACE TABLE {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_INCIDENTS (
    INCIDENT_ID VARCHAR(20),
    INCIDENT_TYPE VARCHAR(30),
    SEVERITY_LEVEL VARCHAR(20),
    AFFECTED_REGION VARCHAR(30),
    INCIDENT_START_TIME TIMESTAMP_NTZ,
    INCIDENT_END_TIME TIMESTAMP_NTZ,
    CUSTOMERS_AFFECTED INTEGER,
    DURATION_MINUTES INTEGER,
    REVENUE_IMPACT FLOAT
);

INSERT INTO {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_INCIDENTS VALUES
('INC_2025_001', 'HARDWARE_FAILURE', 'CRITICAL', 'Northeast', DATEADD(day, -2, CURRENT_TIMESTAMP()), DATEADD(hour, -46, CURRENT_TIMESTAMP()), 15000, 105, 25000.50),
('INC_2025_002', 'NETWORK_CONGESTION', 'HIGH', 'West_Coast', DATEADD(day, -1, CURRENT_TIMESTAMP()), DATEADD(hour, -22, CURRENT_TIMESTAMP()), 8900, 135, 18500.25),
('INC_2025_003', 'SOFTWARE_BUG', 'MEDIUM', 'Midwest', DATEADD(hour, -12, CURRENT_TIMESTAMP()), DATEADD(hour, -10, CURRENT_TIMESTAMP()), 5800, 95, 8900.75),
('INC_2025_045', 'POWER_OUTAGE', 'CRITICAL', 'Texas', DATEADD(day, -3, CURRENT_TIMESTAMP()), DATEADD(day, -2, CURRENT_TIMESTAMP()), 32000, 205, 45000.75),
('INC_2025_046', 'EQUIPMENT_MAINTENANCE', 'LOW', 'California', DATEADD(hour, -48, CURRENT_TIMESTAMP()), DATEADD(hour, -46, CURRENT_TIMESTAMP()), 1200, 150, 2500.00),
('INC_2025_089', 'FIBER_CUT', 'HIGH', 'Florida', DATEADD(day, -4, CURRENT_TIMESTAMP()), DATEADD(day, -3, CURRENT_TIMESTAMP()), 12500, 165, 22000.30),
('INC_2025_090', 'CONFIGURATION_ERROR', 'MEDIUM', 'Ohio', DATEADD(day, -5, CURRENT_TIMESTAMP()), DATEADD(hour, -116, CURRENT_TIMESTAMP()), 3400, 95, 5800.15),

-- EXPANDED SAMPLE DATA: Additional Network Incidents
-- Recent Critical Incidents
('INC_2025_091', 'DDOS_ATTACK', 'CRITICAL', 'New_York', DATEADD(hour, -72, CURRENT_TIMESTAMP()), DATEADD(hour, -70, CURRENT_TIMESTAMP()), 45000, 120, 85000.50),
('INC_2025_092', 'DATA_CENTER_FAILURE', 'CRITICAL', 'Virginia', DATEADD(hour, -48, CURRENT_TIMESTAMP()), DATEADD(hour, -44, CURRENT_TIMESTAMP()), 28000, 240, 125000.75),
('INC_2025_093', 'CABLE_CUT', 'HIGH', 'Georgia', DATEADD(hour, -36, CURRENT_TIMESTAMP()), DATEADD(hour, -32, CURRENT_TIMESTAMP()), 18500, 240, 45000.25),

-- Weather-Related Incidents
('INC_2025_094', 'HURRICANE_DAMAGE', 'CRITICAL', 'Florida_Keys', DATEADD(day, -7, CURRENT_TIMESTAMP()), DATEADD(day, -5, CURRENT_TIMESTAMP()), 65000, 2880, 250000.00),
('INC_2025_095', 'TORNADO_DAMAGE', 'CRITICAL', 'Kansas', DATEADD(day, -10, CURRENT_TIMESTAMP()), DATEADD(day, -9, CURRENT_TIMESTAMP()), 12500, 720, 45000.75),
('INC_2025_096', 'FLOOD_DAMAGE', 'HIGH', 'Louisiana', DATEADD(day, -12, CURRENT_TIMESTAMP()), DATEADD(day, -11, CURRENT_TIMESTAMP()), 22000, 1080, 75000.25),
('INC_2025_097', 'ICE_STORM', 'HIGH', 'Minnesota', DATEADD(day, -15, CURRENT_TIMESTAMP()), DATEADD(day, -14, CURRENT_TIMESTAMP()), 15800, 960, 38000.50),
('INC_2025_098', 'WILDFIRE_EVACUATION', 'CRITICAL', 'California_North', DATEADD(day, -20, CURRENT_TIMESTAMP()), DATEADD(day, -18, CURRENT_TIMESTAMP()), 35000, 2160, 125000.00),

-- Cyber Security Incidents
('INC_2025_099', 'RANSOMWARE_ATTEMPT', 'HIGH', 'Corporate_Network', DATEADD(day, -8, CURRENT_TIMESTAMP()), DATEADD(day, -7, CURRENT_TIMESTAMP()), 2500, 180, 15000.00),
('INC_2025_100', 'PHISHING_ATTACK', 'MEDIUM', 'Customer_Portal', DATEADD(day, -6, CURRENT_TIMESTAMP()), DATEADD(hour, -138, CURRENT_TIMESTAMP()), 850, 45, 2500.00),
('INC_2025_101', 'DATA_BREACH_ATTEMPT', 'HIGH', 'Billing_System', DATEADD(hour, -84, CURRENT_TIMESTAMP()), DATEADD(hour, -82, CURRENT_TIMESTAMP()), 1200, 120, 8500.00),

-- Infrastructure Failures
('INC_2025_102', 'COOLING_SYSTEM_FAILURE', 'HIGH', 'Arizona_DC', DATEADD(day, -4, CURRENT_TIMESTAMP()), DATEADD(day, -3, CURRENT_TIMESTAMP()), 8900, 480, 28000.75),
('INC_2025_103', 'GENERATOR_FAILURE', 'MEDIUM', 'Backup_Site_TX', DATEADD(hour, -96, CURRENT_TIMESTAMP()), DATEADD(hour, -92, CURRENT_TIMESTAMP()), 3200, 240, 12000.50),
('INC_2025_104', 'ROUTER_OVERHEATING', 'LOW', 'Nevada', DATEADD(hour, -60, CURRENT_TIMESTAMP()), DATEADD(hour, -58, CURRENT_TIMESTAMP()), 1800, 120, 4500.25),
('INC_2025_105', 'SWITCH_FAILURE', 'MEDIUM', 'Colorado', DATEADD(hour, -108, CURRENT_TIMESTAMP()), DATEADD(hour, -104, CURRENT_TIMESTAMP()), 5600, 240, 18000.00),

-- Software and Configuration Issues
('INC_2025_106', 'SOFTWARE_UPDATE_FAILED', 'MEDIUM', 'Michigan', DATEADD(day, -9, CURRENT_TIMESTAMP()), DATEADD(day, -8, CURRENT_TIMESTAMP()), 7200, 180, 22000.50),
('INC_2025_107', 'DATABASE_CORRUPTION', 'HIGH', 'Illinois', DATEADD(hour, -120, CURRENT_TIMESTAMP()), DATEADD(hour, -115, CURRENT_TIMESTAMP()), 9800, 300, 35000.75),
('INC_2025_108', 'LOAD_BALANCER_ERROR', 'MEDIUM', 'Washington', DATEADD(hour, -72, CURRENT_TIMESTAMP()), DATEADD(hour, -69, CURRENT_TIMESTAMP()), 4500, 180, 15000.25),
('INC_2025_109', 'DNS_RESOLUTION_FAILURE', 'HIGH', 'Oregon', DATEADD(hour, -156, CURRENT_TIMESTAMP()), DATEADD(hour, -152, CURRENT_TIMESTAMP()), 12000, 240, 42000.00),

-- Vendor and Third-Party Issues
('INC_2025_110', 'VENDOR_OUTAGE', 'HIGH', 'Multi_State', DATEADD(day, -11, CURRENT_TIMESTAMP()), DATEADD(day, -10, CURRENT_TIMESTAMP()), 25000, 420, 85000.50),
('INC_2025_111', 'CLOUD_PROVIDER_ISSUE', 'MEDIUM', 'East_Coast', DATEADD(hour, -144, CURRENT_TIMESTAMP()), DATEADD(hour, -140, CURRENT_TIMESTAMP()), 8500, 240, 28000.75),
('INC_2025_112', 'ISP_ROUTING_ERROR', 'LOW', 'Utah', DATEADD(hour, -48, CURRENT_TIMESTAMP()), DATEADD(hour, -46, CURRENT_TIMESTAMP()), 2800, 120, 8500.00),

-- Planned Maintenance Issues
('INC_2025_113', 'MAINTENANCE_OVERRUN', 'LOW', 'Idaho', DATEADD(day, -13, CURRENT_TIMESTAMP()), DATEADD(day, -12, CURRENT_TIMESTAMP()), 1500, 300, 4500.00),
('INC_2025_114', 'UNEXPECTED_DOWNTIME', 'MEDIUM', 'Montana', DATEADD(hour, -168, CURRENT_TIMESTAMP()), DATEADD(hour, -164, CURRENT_TIMESTAMP()), 3800, 240, 12000.25),

-- Capacity and Traffic Issues
('INC_2025_115', 'TRAFFIC_SPIKE', 'MEDIUM', 'Stadium_Event', DATEADD(hour, -24, CURRENT_TIMESTAMP()), DATEADD(hour, -21, CURRENT_TIMESTAMP()), 15000, 180, 28000.50),
('INC_2025_116', 'BANDWIDTH_EXHAUSTION', 'HIGH', 'Business_District', DATEADD(hour, -18, CURRENT_TIMESTAMP()), DATEADD(hour, -15, CURRENT_TIMESTAMP()), 8900, 180, 22000.75),
('INC_2025_117', 'CONGESTION_OVERLOAD', 'MEDIUM', 'Airport_Hub', DATEADD(hour, -12, CURRENT_TIMESTAMP()), DATEADD(hour, -10, CURRENT_TIMESTAMP()), 6500, 120, 18000.00),

-- Equipment Theft and Vandalism
('INC_2025_118', 'EQUIPMENT_THEFT', 'HIGH', 'Remote_Tower_Site', DATEADD(day, -16, CURRENT_TIMESTAMP()), DATEADD(day, -14, CURRENT_TIMESTAMP()), 4500, 2880, 35000.00),
('INC_2025_119', 'VANDALISM', 'MEDIUM', 'Urban_Cell_Site', DATEADD(day, -14, CURRENT_TIMESTAMP()), DATEADD(day, -13, CURRENT_TIMESTAMP()), 2800, 720, 15000.50),

-- Environmental Issues
('INC_2025_120', 'DUST_STORM_DAMAGE', 'MEDIUM', 'Arizona', DATEADD(day, -18, CURRENT_TIMESTAMP()), DATEADD(day, -17, CURRENT_TIMESTAMP()), 8200, 480, 25000.75),
('INC_2025_121', 'EARTHQUAKE_DAMAGE', 'CRITICAL', 'California_South', DATEADD(day, -25, CURRENT_TIMESTAMP()), DATEADD(day, -23, CURRENT_TIMESTAMP()), 75000, 2880, 350000.00),

-- Vehicle Accidents and Physical Damage
('INC_2025_122', 'VEHICLE_COLLISION', 'HIGH', 'Highway_Tower', DATEADD(hour, -96, CURRENT_TIMESTAMP()), DATEADD(hour, -90, CURRENT_TIMESTAMP()), 6800, 360, 22000.50),
('INC_2025_123', 'CONSTRUCTION_DAMAGE', 'MEDIUM', 'Urban_Fiber', DATEADD(day, -6, CURRENT_TIMESTAMP()), DATEADD(day, -5, CURRENT_TIMESTAMP()), 3200, 480, 12000.75),

-- Recent Minor Incidents (Last 24 Hours)
('INC_2025_124', 'ANTENNA_MISALIGNMENT', 'LOW', 'Nebraska', DATEADD(hour, -6, CURRENT_TIMESTAMP()), DATEADD(hour, -4, CURRENT_TIMESTAMP()), 850, 120, 2500.00),
('INC_2025_125', 'BACKUP_BATTERY_FAILURE', 'LOW', 'Remote_Site_WY', DATEADD(hour, -3, CURRENT_TIMESTAMP()), DATEADD(hour, -2, CURRENT_TIMESTAMP()), 450, 60, 1200.00),
('INC_2025_126', 'ALARM_MALFUNCTION', 'LOW', 'Monitoring_Center', DATEADD(hour, -1, CURRENT_TIMESTAMP()), CURRENT_TIMESTAMP(), 0, 60, 500.00);

-- 5. NETWORK REPORTS PARSED (Document AI Results)
CREATE OR REPLACE TABLE {{env.DATAOPS_DATABASE }}.{{env.DOCUMENT_AI_SCHEMA}}.NETWORK_REPORTS_PARSED (
    REPORT_TYPE VARCHAR(30),
    SOURCE_SYSTEM VARCHAR(50),
    QUARTER VARCHAR(5),
    REPORT_DATE DATE,
    NETWORK_AVAILABILITY_PERCENT DECIMAL(5,2),
    TOTAL_SUBSCRIBERS INTEGER,
    PEAK_TRAFFIC_GBPS DECIMAL(10,2),
    INCIDENT_COUNT INTEGER,
    AVERAGE_RESOLUTION_TIME_HOURS DECIMAL(6,2)
);

INSERT INTO {{env.DATAOPS_DATABASE }}.{{env.DOCUMENT_AI_SCHEMA}}.NETWORK_REPORTS_PARSED VALUES
('PERFORMANCE_DASHBOARD', 'NETWORK_MONITORING_SYSTEM', 'Q2', CURRENT_DATE() - 31, 99.95, 5250000, 850.25, 25, 2.5),
('PERFORMANCE_DASHBOARD', 'NETWORK_MONITORING_SYSTEM', 'Q2', CURRENT_DATE() - 15, 99.87, 5875000, 920.75, 18, 1.8),
('PERFORMANCE_DASHBOARD', 'NETWORK_MONITORING_SYSTEM', 'Q3', CURRENT_DATE() - 7, 99.92, 6100000, 1050.50, 32, 3.2),
('INCIDENT_REPORT', 'INCIDENT_MANAGEMENT_TOOL', 'Q2', CURRENT_DATE() - 28, 99.85, 5250000, 800.00, 45, 3.1),
('INCIDENT_REPORT', 'INCIDENT_MANAGEMENT_TOOL', 'Q3', CURRENT_DATE() - 10, 99.90, 5875000, 850.25, 38, 2.7),
('MAINTENANCE_LOG', 'MAINTENANCE_TRACKER', 'Q2', CURRENT_DATE() - 25, 99.98, 5250000, 750.00, 12, 1.5),
('MAINTENANCE_LOG', 'MAINTENANCE_TRACKER', 'Q3', CURRENT_DATE() - 5, 99.95, 5875000, 800.50, 15, 1.8);

-- 6. NETWORK DOCUMENTATION FOR CORTEX SEARCH
CREATE OR REPLACE TABLE {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_DOCUMENTATION (
    DOCUMENT_ID VARCHAR(50),
    DOCUMENT_TYPE VARCHAR(30),
    TITLE VARCHAR(200),
    CONTENT TEXT,
    TAGS VARCHAR(500),
    CREATED_DATE DATE
);

INSERT INTO {{ env.DATAOPS_DATABASE }}.{{ env.EVENT_SCHEMA }}.NETWORK_DOCUMENTATION VALUES
('DOC_001', 'TROUBLESHOOTING', '5G Network Latency Issues', 
'When experiencing high latency on 5G networks, first check the signal strength and tower proximity. Common causes include network congestion during peak hours, interference from other electronic devices, and suboptimal tower configuration. Resolution steps: 1) Check tower load balancing, 2) Verify RF settings, 3) Monitor for interference sources, 4) Consider traffic shaping policies.', 
'5G,latency,troubleshooting,network,performance', CURRENT_DATE() - 30),
('DOC_002', 'BEST_PRACTICES', 'Customer Data Usage Optimization',
'Best practices for optimizing customer data usage include implementing traffic prioritization, enabling data compression, and providing usage alerts. Monitor customer usage patterns to identify potential service upgrades and implement fair usage policies to ensure network quality for all subscribers.',
'customer,data,usage,optimization,traffic', CURRENT_DATE() - 25),
('DOC_003', 'INCIDENT_RESPONSE', 'Critical Incident Response Protocol',
'For critical network incidents affecting more than 10,000 customers: 1) Immediate escalation to Network Operations Center, 2) Customer communication within 15 minutes, 3) Engage vendor support if hardware-related, 4) Implement emergency routing if available, 5) Post-incident analysis within 24 hours.',
'incident,response,critical,protocol,customers', CURRENT_DATE() - 20),
('DOC_004', 'MAINTENANCE', 'Planned Maintenance Windows',
'Standard maintenance windows are scheduled during low-traffic periods (2 AM - 6 AM local time). All maintenance must be approved 48 hours in advance, with customer notifications sent 24 hours prior. Emergency maintenance procedures allow for immediate action when service availability is at risk.',
'maintenance,windows,planning,notifications,emergency', CURRENT_DATE() - 15),
('DOC_005', 'NETWORK_PLANNING', '5G Network Expansion Guidelines',
'5G network expansion should prioritize high-density urban areas and business districts. Site selection criteria include population density, existing infrastructure, fiber backhaul availability, and regulatory compliance. Expected coverage radius for 5G sites is 1-3 km in urban areas, 5-10 km in suburban areas.',
'5G,expansion,planning,coverage,infrastructure', CURRENT_DATE() - 10),

-- EXPANDED SAMPLE DATA: Additional Network Documentation
('DOC_006', 'SECURITY', 'Cybersecurity Framework for Telco Networks',
'Comprehensive cybersecurity framework includes multi-layered defense strategies: 1) Network segmentation and zero-trust architecture, 2) Real-time threat monitoring with AI-powered detection, 3) Encrypted communications using quantum-resistant algorithms, 4) Regular penetration testing and vulnerability assessments. Critical infrastructure requires 24/7 SOC monitoring with automated incident response capabilities.',
'security,cybersecurity,threat,monitoring,encryption,SOC', CURRENT_DATE() - 5),

('DOC_007', 'OPTIMIZATION', 'Network Performance Optimization Techniques',
'Advanced optimization techniques for modern telecom networks: Traffic engineering using MPLS and SD-WAN, dynamic spectrum allocation for 5G networks, edge computing deployment for reduced latency, AI-driven predictive maintenance, and automated load balancing algorithms. Monitor KPIs including latency, throughput, packet loss, and jitter for optimal user experience.',
'optimization,performance,traffic,engineering,AI,edge,computing', CURRENT_DATE() - 8),

('DOC_008', 'DISASTER_RECOVERY', 'Business Continuity and Disaster Recovery Plan',
'Disaster recovery protocols ensure network resilience: Primary data centers with geographically distributed backups, automatic failover systems with <30 second recovery times, emergency communication channels for first responders, backup power systems with 72-hour capacity, and mobile cell sites for rapid deployment. Regular DR testing conducted quarterly.',
'disaster,recovery,backup,failover,emergency,continuity', CURRENT_DATE() - 12),

('DOC_009', 'IOT_INTEGRATION', 'IoT Device Management and Integration',
'IoT ecosystem management covering device onboarding, authentication, and lifecycle management. Supports massive IoT deployments with up to 1 million devices per square kilometer using NB-IoT and LTE-M technologies. Device security includes PKI certificates, secure boot, and over-the-air updates. Network slicing ensures QoS isolation for critical IoT applications.',
'IoT,devices,NB-IoT,LTE-M,security,slicing,massive', CURRENT_DATE() - 15),

('DOC_010', 'CUSTOMER_ANALYTICS', 'Customer Experience Analytics and Insights',
'Customer analytics platform provides real-time insights into user behavior, service quality perception, and network performance impact on customer satisfaction. Machine learning models predict churn risk, optimize service recommendations, and identify network issues before customer complaints. Dashboard includes NPS scores, usage patterns, and revenue analytics.',
'customer,analytics,experience,churn,satisfaction,ML', CURRENT_DATE() - 18),

('DOC_011', 'EDGE_COMPUTING', 'Edge Computing Deployment Guide',
'Multi-access Edge Computing (MEC) deployment strategies for ultra-low latency applications. Edge nodes support AR/VR, autonomous vehicles, and industrial IoT with <10ms latency requirements. Infrastructure includes containerized workloads, kubernetes orchestration, and APIs for third-party applications. Edge-to-cloud data synchronization ensures consistency.',
'edge,computing,MEC,latency,AR,VR,autonomous,kubernetes', CURRENT_DATE() - 22),

('DOC_012', 'QUALITY_ASSURANCE', 'Service Quality Monitoring and SLA Management',
'Comprehensive quality assurance framework monitors end-to-end service quality across voice, data, and video services. Automated testing includes call quality analysis, data throughput measurements, and video streaming quality metrics. SLA management tracks availability (99.9%), latency (<50ms), and customer satisfaction scores (>4.0/5.0).',
'quality,SLA,monitoring,voice,data,video,availability', CURRENT_DATE() - 25),

('DOC_013', 'CAPACITY_PLANNING', 'Network Capacity Planning and Forecasting',
'Predictive capacity planning using AI/ML models to forecast traffic growth, identify bottlenecks, and optimize resource allocation. Analysis includes historical usage trends, seasonal patterns, special events impact, and demographic changes. Automated scaling recommendations for network infrastructure and spectrum allocation.',
'capacity,planning,forecasting,AI,ML,traffic,scaling', CURRENT_DATE() - 28),

('DOC_014', 'COMPLIANCE', 'Regulatory Compliance and Standards',
'Regulatory compliance framework covering FCC regulations, GDPR data protection, HIPAA healthcare requirements, and industry standards (3GPP, ETSI, IEEE). Regular audits ensure compliance with emergency alert systems, accessibility requirements, and consumer protection laws. Documentation includes compliance checklists and audit trails.',
'compliance,regulatory,FCC,GDPR,HIPAA,standards,audit', CURRENT_DATE() - 32),

('DOC_015', 'AUTOMATION', 'Network Automation and Orchestration',
'End-to-end network automation using SDN/NFV technologies, intent-based networking, and AI-driven operations. Automated workflows include service provisioning, fault detection and remediation, performance optimization, and security policy enforcement. Zero-touch provisioning reduces deployment time from hours to minutes.',
'automation,orchestration,SDN,NFV,intent,AI,zero-touch', CURRENT_DATE() - 35),

('DOC_016', 'ROAMING', 'International Roaming Configuration Guide',
'International roaming setup and optimization covering bilateral agreements, technical configurations, and quality assurance. Includes GSMA guidelines compliance, steering of roaming, and fraud prevention mechanisms. Real-time monitoring of roaming traffic quality and revenue assurance processes.',
'roaming,international,GSMA,agreements,fraud,revenue', CURRENT_DATE() - 38),

('DOC_017', 'SPECTRUM', 'Spectrum Management and Optimization',
'Dynamic spectrum management for efficient frequency allocation across 2G, 3G, 4G, and 5G technologies. Includes carrier aggregation strategies, spectrum sharing protocols, and interference mitigation techniques. Cognitive radio implementation for opportunistic spectrum usage and coordination with regulatory authorities.',
'spectrum,management,frequency,aggregation,interference,cognitive', CURRENT_DATE() - 42),

('DOC_018', 'TESTING', 'Network Testing and Validation Procedures',
'Comprehensive testing framework for new services and network upgrades: Unit testing, integration testing, performance testing, and acceptance testing. Automated test suites for regression testing, load testing, and security vulnerability assessments. Test environment management and CI/CD pipeline integration.',
'testing,validation,performance,security,automation,CI/CD', CURRENT_DATE() - 45),

('DOC_019', 'MIGRATION', '5G Network Migration and Modernization',
'Step-by-step guide for migrating from legacy networks to 5G infrastructure. Includes spectrum refarming strategies, equipment replacement schedules, and service continuity plans. Dual-mode operation during transition periods and customer communication strategies for service improvements.',
'migration,5G,modernization,spectrum,refarming,transition', CURRENT_DATE() - 48),

('DOC_020', 'ENERGY', 'Green Network Initiative and Energy Efficiency',
'Sustainability initiatives for reducing network carbon footprint: Energy-efficient equipment deployment, renewable energy integration, intelligent power management, and carbon offset programs. Green network design principles and environmental impact measurement frameworks.',
'green,energy,efficiency,sustainability,renewable,carbon', CURRENT_DATE() - 52);


-- If data sharing enambled, create a database from the share
{% if env.EVENT_DATA_SHARING == "true" %}
use role {{ env.EVENT_ATTENDEE_ROLE }};
create database if not exists {{ env.EVENT_SHARE }} from share {{ env.DATAOPS_SHARE_ACCOUNT | replace('-', '.') | upper }}.{{ env.EVENT_SHARE }};
grant imported privileges on database {{ env.EVENT_SHARE }} to role PUBLIC;
{% endif %}
